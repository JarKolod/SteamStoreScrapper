### TODO:
* clean this spagheti
* do ("better")exception handling